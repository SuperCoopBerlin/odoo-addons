<?xml version="1.0" encoding="UTF-8" ?>
<templates id="template" xml:space="preserve">
    <t t-extend="XmlReceipt">

        <!-- Make receipt wider (initial value 40, max value 48)-->
        <t t-jquery="receipt" t-operation="attributes">
            <attribute name="width">44</attribute>
        </t>

        <!-- Add/modify company details -->
        <t t-jquery="t[t-if='receipt.company.contact_address']" t-operation="after">
            <t t-if='widget.pos.company.street'>
                <div><t t-esc='receipt.company.street' /></div>
            </t>
            <t t-if='widget.pos.company.street2'>
                <div><t t-esc='receipt.company.street2' /></div>
            </t>
            <t t-if='widget.pos.company.zip'>
                <t t-if='widget.pos.company.city'>
                    <div><t t-esc='receipt.company.zip' /> <t t-esc='receipt.company.city' /></div>
                </t>
            </t>
        </t>
        <t t-jquery="t[t-if='receipt.company.email']" t-operation="replace" />
        <t t-jquery="t[t-if='receipt.company.vat']" t-operation="replace" />
        <t t-jquery="t[t-if='receipt.company.website']" t-operation="after" >
            <t t-if='receipt.company.vat'>
                <div>VAT: <t t-esc='receipt.company.vat' /></div>
            </t>
        </t>

        <!-- Make left column wider, apply translation for Unit(s) -->
        <t t-jquery="div[class='orderlines']" t-operation="replace">
            <div class='orderlines' line-ratio='0.75'>
                <t t-foreach='receipt.orderlines' t-as='line'>
                    <t t-set='simple' t-value='line.discount === 0 and line.unit_name === "Einheit(en)" and line.quantity === 1' />
                    <t t-if='simple'>
                        <line>
                            <left><t t-esc='line.product_name_wrapped[0]' /></left>
                            <right><value t-att-value-decimals='pos.currency.decimals'><t t-esc='line.price_display' /></value></right>
                        </line>
                        <t t-call="XmlReceiptWrappedProductNameLines"/>
                    </t>
                    <t t-if='!simple'>
                        <line><left><t t-esc='line.product_name_wrapped[0]' /></left></line>
                        <t t-call="XmlReceiptWrappedProductNameLines"/>
                        <t t-if='line.discount !== 0'>
                            <line indent='1'><left>Discount: <t t-esc='line.discount' />%</left></line>
                        </t>
                        <line indent='1'>
                            <left>
                                <value t-att-value-decimals='pos.dp["Product Unit of Measure"]' value-autoint='on'>
                                    <t t-esc='line.quantity' />
                                </value>
                                <t t-if='line.unit_name !== "Einheit(en)"'>
                                    <t t-esc='line.unit_name' />
                                </t>
                                x
                                <value t-att-value-decimals='pos.dp["Product Price"]'>
                                    <t t-esc='line.price' />
                                </value>
                            </left>
                            <right>
                                <value t-att-value-decimals='pos.currency.decimals'><t t-esc='line.price_display' /></value>
                            </right>
                        </line>
                    </t>
                </t>
            </div>
        </t>

        <!-- Make Change single-height-->
        <!--
                <xpath expr="//line[@size='double-height']//left//pre[contains(text(),'CHANGE')]/../.." position="replace">
        -->
        <t t-jquery="line[size='double-height']:contains('CHANGE')" t-operation="replace">
            <line>
                <left>Change</left>
                <right><t t-esc='widget.format_currency(receipt.change)' /></right>
            </line>
        </t>


    </t>


    <t t-extend="PosTicket">

        <!-- add logo -->
        <t t-jquery="div[class='pos-sale-ticket']" t-operation="prepend">
            <div class="pos-center-align">
                <t t-if='receipt.company.logo'>
                    <img t-att-src='receipt.company.logo' style='max-width:75%' alt="Logo"/>
                    <br/>
                </t>
                <t t-if='!receipt.company.logo'>
                    <h1><t t-esc='receipt.company.name' /></h1>
                    <br/>
                </t>
            </div>
        </t>

        <!-- add company details -->
        <t t-jquery="div[class='receipt-phone']" t-operation="replace">
            <t t-if='widget.pos.company.street'>
                <div><t t-esc='receipt.company.street' /></div>
            </t>
            <t t-if='widget.pos.company.street2'>
                <div><t t-esc='receipt.company.street2' /></div>
            </t>
            <t t-if='widget.pos.company.zip'>
                <t t-if='widget.pos.company.city'>
                    <div><t t-esc='receipt.company.zip' /> <t t-esc='receipt.company.city' /></div>
                </t>
            </t>
            <t t-if='receipt.company.vat'>
                <div>VAT: <t t-esc='receipt.company.vat' /></div>
            </t>
            
            <t t-if='receipt.company.website'>
                <div><t t-esc='receipt.company.website' /></div>
            </t>
            <br /><br />
        </t>
        <t t-jquery="div[class='receipt-user']" t-operation="replace">
        </t>

    </t>
</templates>
